#!/usr/bin/env bash
# Go environment settings
export GODEBUG=netdns=go
export GOPROXY=https://proxy.golang.org,direct
export GOINSECURE=proxy.golang.org,goproxy.io
# export GIT_SSL_NO_VERIFY=1  # Temporary if SSL issues persist
# layout hatch
use_uv() {
    if ! command -v uv >/dev/null 2>&1; then
        echo "uv not found. Install uv first: https://docs.astral.sh/uv/" >&2
        return 1
    fi

    # Create venv if missing
    if [[ ! -d .venv ]]; then
        uv venv
    fi

    # Keep venv on PATH
    PATH_add "$PWD/.venv/bin"
    export VIRTUAL_ENV="$PWD/.venv"

    # Sync project deps. If you added the 'hatch' extra to default features, this installs hatch with click<8.3.
    # Use --all-extras or specify exactly what you want to install locally.
    uv sync --all-extras
}

use_uv

# Project venv (uv-managed)
if [[ ! -d .venv ]]; then uv venv; fi
export PATH="$PWD/.venv/bin:$HOME/.local/bin:$PATH"
export VIRTUAL_ENV="$PWD/.venv"
uv sync # or uv sync --all-extras if thatâ€™s your norm
